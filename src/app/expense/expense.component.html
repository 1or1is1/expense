<div class="container py-2 py-md-3 my-4 my-md-5">
  <header class="d-flex justify-content-between align-items-center">
    <span class="fs-2 fw-bold me-auto">Expenses</span>
    <span
      ><a class="btn btn-primary" routerLink="addExpense">Add Expense</a></span
    >
  </header>
  <hr />
  <div class="row gap-3 gap-md-4 mt-3 mt-md-4">
    <div class="col-12">
      <h4>Summary</h4>
    </div>
    <div class="col-12 col-md-4 col-lg-3">
      <div class="card bg-secondary expense-shadow rounded-1">
        <div class="card-body">
          <h6 class="card-title text-uppercase">Total Expenses</h6>
          <h2 *ngIf="totalExpenses !== null; else loadingTemplate">
            {{ totalExpenses }}
          </h2>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-4 col-lg-3">
      <div class="card expense-shadow bg-secondary rounded-1">
        <div class="card-body">
          <h6 class="card-title text-uppercase">Total Amount</h6>
          <h2 *ngIf="totalExpensesCost !== null; else loadingTemplate">
            {{ totalExpensesCost | currency: "INR" }}
          </h2>
        </div>
      </div>
    </div>
  </div>
  <div class="row gap-3 gap-md-4 mt-3 mt-md-4">
    <div class="col-12">
      <div class="table-responsive table-container expense-shadow mb-2 h-100">
        <table
          class="table table-bordered table-striped table-hover mb-0 h-100"
        >
          <thead>
            <tr>
              <th data-cell="name">Name</th>
              <th data-cell="price">Price</th>
              <th data-cell="spent date">Spent Date</th>
              <th data-cell="category">Category</th>
              <th data-cell="paid via">Paid Via</th>
              <th data-cell="notes">Notes</th>
              <th data-cell="actions">Actions</th>
            </tr>
          </thead>
          <tbody class="table-group-divider">
            <tr
              *ngFor="let expense of expenses$ | async"
              class="align-middle"
              style="--bs-table-hover-bg: var(--bs-primary-bg-subtle)"
            >
              <td>{{ expense.name }}</td>
              <td>{{ expense.price | currency: "INR" }}</td>
              <td>{{ expense.spentDate | date }}</td>
              <td>{{ expense.category }}</td>
              <td>{{ expense.paidVia }}</td>
              <td>{{ expense.notes }}</td>
              <td>
                <fieldset [disabled]="loadingDelete">
                  <a
                    class="btn btn-outline-dark me-1 btn-sm"
                    title="edit"
                    type="button"
                    [routerLink]="[
                      '/expenses',
                      'editExpense',
                      expense.expenseId
                    ]"
                  >
                    <i class="ri-edit-line"></i>
                  </a>
                  <button
                    class="btn btn-outline-danger btn-sm"
                    title="delete"
                    type="button"
                    (click)="deleteExpense(expense.expenseId)"
                  >
                    <i class="ri-delete-bin-line"></i>
                  </button>
                </fieldset>
              </td>
            </tr>
            <ng-container *ngIf="totalExpenses === null || totalExpenses === 0">
              <tr>
                <td colspan="7" class="align-middle">
                  <h1 class="text-center">No Records...</h1>
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<ng-template #loadingTemplate>
  <div class="spinner-border spinner-border-sm" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
</ng-template>
